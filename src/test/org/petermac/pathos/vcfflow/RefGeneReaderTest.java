package test.org.petermac.pathos.vcfflow;

import oracle.jrockit.jfr.StringConstantPool;
import org.junit.Test;
import static org.junit.Assert.assertEquals;

import org.petermac.pathos.vcfflow.FileFactory;
import org.petermac.pathos.vcfflow.RefGeneProcessor;
import org.petermac.pathos.vcfflow.RefGeneReader;
import org.petermac.pathos.vcfflow.StringFileFactory;

import java.util.ArrayList;

/** 
* RefGeneReader Tester. 
* 
* @author <Authors name> 
* @since <pre>Aug. 19, 2019</pre> 
* @version 1.0 
*/ 
public class RefGeneReaderTest { 

    public static class TestRefGeneProcessor implements RefGeneProcessor {
        public String accession;
        public String chrom;
        public Strand strand;
        public int txStart;
        public int txEnd;
        public int cdsStart;
        public int cdsEnd;
        public int exonCount;
        public int[] exonStarts;
        public int[] exonEnds;
        public int[] exonFrames;
        public String name;
        public CdsStat cdsStartStat;
        public CdsStat cdsEndStat;

        public ArrayList<String> accessions;

        @Override
        public void begin() {
            accessions = new ArrayList<>();
        }

        @Override
        public void accept(String accession, String chrom, Strand strand, int txStart, int txEnd, int cdsStart, int cdsEnd, int exonCount, int[] exonStarts, int[] exonEnds, int[] exonFrames, String name, CdsStat cdsStartStat, CdsStat cdsEndStat) {
            this.accession = accession;
            this.chrom = chrom;
            this.strand = strand;
            this.txStart = txStart;
            this.txEnd = txEnd;
            this.cdsStart = cdsStart;
            this.cdsEnd = cdsEnd;
            this.exonCount = exonCount;
            this.exonStarts = exonStarts;
            this.exonEnds = exonEnds;
            this.exonFrames = exonFrames;
            this.name = name;
            this.cdsStartStat = cdsStartStat;
            this.cdsEndStat = cdsEndStat;

            this.accessions.add(accession);
        }

        @Override
        public void end() {

        }
    }

    /**
     *
     * Method: processLine(String line)
     *
     */
    @Test
    public void testProcessLinePos()  {
        String line = "607\tNM_001257098\tchr12\t+\t2986364\t2998691\t2994532\t2997625\t3\t2986364,2994428,2997076,\t2986448,2994700,2998691,\t0\tRHNO1\tcmpl\tcmpl\t-1,0,0,";

        TestRefGeneProcessor t = new TestRefGeneProcessor();
        t.begin();
        RefGeneReader R = new RefGeneReader(new FileFactory(), t);
        R.processLine(line);
        assertEquals("NM_001257098", t.accession);
        assertEquals("chr12", t.chrom);
        assertEquals(RefGeneProcessor.Strand.POS, t.strand);
        int txStart = 2986364;
        assertEquals(txStart, t.txStart);
        int txEnd = 2998691;
        assertEquals(txEnd, t.txEnd);
    }

    @Test
    public void testProcessVcf()  {
        StringFileFactory fac = new StringFileFactory();
        String vcfText = String.join("\n", new String[]{
                "9\tNM_001500\tchr6\t-\t1624034\t2245868\t1624403\t2245656\t11\t1624034,1624706,1726649,1742701,1930336,1960100,1961007,2116004,2117702,2124920,2245554,\t1624466,1624775,1726746,1742820,1930464,1960205,1961200,2116114,2117790,2124965,2245868,\t0\tGMDS\tcmpl\tcmpl\t0,0,2,0,1,1,0,1,0,0,0,",
                "1047\tNM_207341\tchr11\t+\t60635014\t60643164\t60635034\t60643129\t12\t60635014,60636617,60637009,60637804,60638429,60638689,60640634,60640847,60641106,60642405,60642601,60642986,\t60635230,60636739,60637373,60637948,60638617,60638787,60640762,60641037,60641248,60642487,60642721,60643164,\t0\tZP1\tcmpl\tcmpl\t0,1,0,1,1,0,2,1,2,0,1,1,",
                "1501\tNM_173571\tchrX\t-\t120082276\t120085594\t120083585\t120085339\t3\t120082276,120083554,120084597,\t120082416,120083710,120085594,\t0\tCT47A11\tcmpl\tcmpl\t-1,1,0,",
                "670\tNM_176889\tchr12\t-\t11148560\t11150903\t11149544\t11150474\t1\t11148560,\t11150903,\t0\tTAS2R20\tcmpl\tcmpl\t0,",
                "11\tNM_005940\tchr22\t+\t24115005\t24126503\t24115057\t24125731\t8\t24115005,24121373,24122545,24122768,24123045,24123379,24124412,24125597,\t24115165,24121603,24122689,24122902,24123287,24123596,24124670,24126503,\t0\tMMP11\tcmpl\tcmpl\t0,0,2,2,1,0,1,1,",
                "14\tNM_003204\tchr17\t+\t46125685\t46138907\t46128480\t46137003\t6\t46125685,46127968,46133747,46134393,46134705,46135656,\t46125824,46128990,46133960,46134483,46134864,46138907,\t0\tNFE2L1\tcmpl\tcmpl\t-1,0,0,0,0,0,",
                "936\tNM_198698\tchr21\t-\t46074129\t46074576\t46074192\t46074531\t1\t46074129,\t46074576,\t0\tKRTAP12-4\tcmpl\tcmpl\t0,",
                "22\tNM_002045\tchr3\t+\t115342150\t115440334\t115342536\t115439729\t3\t115342150,115394859,115439640,\t115342566,115395457,115440334,\t0\tGAP43\tcmpl\tcmpl\t0,0,1,",
                "1682\tNM_177477\tchr8\t-\t143852614\t143858744\t143856584\t143857375\t4\t143852614,143857010,143857323,143858521,\t143856781,143857112,143857537,143858744,\t0\tLYNX1\tcmpl\tcmpl\t1,1,0,-1,",
                "1014\tNM_000502\tchr17\t+\t56270084\t56282535\t56270207\t56281784\t13\t56270084,56270398,56270731,56271074,56271323,56272324,56274299,56276400,56276899,56277585,56280441,56281582,56282096,\t56270283,56270492,56270907,56271192,56271453,56272531,56274618,56276561,56277155,56277756,56280679,56281795,56282535,\t0\tEPX\tcmpl\tcmpl\t0,1,2,1,2,0,0,1,0,1,1,2,-1,",
                "981\tNM_053003\tchr19\t-\t51994480\t52005043\t51994894\t52004987\t8\t51994480,52000133,52000602,52001271,52002423,52002691,52003173,52004560,\t51995083,52000230,52000699,52001541,52002471,52002970,52003554,52005043,\t0\tSIGLEC12\tcmpl\tcmpl\t0,2,1,1,1,1,1,0,",
                "630\tNM_173565\tchr7\t-\t5965776\t6010314\t5965998\t6006747\t21\t5965776,5967826,5972412,5974650,5977388,5978352,5982954,5983541,5984694,5987850,5990925,5992705,5995635,5997537,5998623,6000321,6004132,6005267,6006493,6006948,6010248,\t5966179,5968025,5972506,5974779,5977532,5978460,5983103,5983621,5984809,5988040,5991047,5992850,5995812,5997658,5998709,6000495,6004201,6005343,6006832,6007068,6010314,\t0\tRSPH10B\tcmpl\tcmpl\t2,1,0,0,0,0,1,2,1,0,1,0,0,2,0,0,0,2,0,-1,-1,",
                "128\tNM_002428\tchr16\t+\t58059469\t58080804\t58060254\t58079350\t10\t58059469,58071375,58072169,58073778,58074440,58075520,58076134,58077113,58077415,58078910,\t58060416,58071524,58072298,58074086,58074602,58075774,58076273,58077264,58077531,58080804,\t0\tMMP15\tcmpl\tcmpl\t0,0,2,2,1,1,0,1,2,1,",
                "2421\tNM_022469\tchr1\t-\t240652872\t240775462\t240656268\t240656775\t2\t240652872,240775183,\t240656776,240775462,\t0\tGREM2\tcmpl\tcmpl\t0,-1,",
                "1740\tNM_006439\tchr4\t+\t151503076\t151505845\t151504181\t151505261\t1\t151503076,\t151505845,\t0\tMAB21L2\tcmpl\tcmpl\t0,",
                "642\tNM_020533\tchr19\t+\t7587495\t7598895\t7587636\t7598681\t14\t7587495,7589846,7591324,7591646,7592405,7592749,7593043,7593482,7593706,7593986,7594475,7595171,7598408,7598644,\t7587667,7590052,7591492,7591812,7592514,7592846,7593143,7593589,7593856,7594088,7594598,7595387,7598539,7598895,\t0\tMCOLN1\tcmpl\tcmpl\t0,1,0,0,1,2,0,1,0,0,0,0,0,2,",
                "861\tNM_173676\tchr6\t+\t36210944\t36276372\t36259176\t36275493\t8\t36210944,36259096,36260837,36261966,36263140,36269637,36274068,36275363,\t36211038,36259329,36260903,36262176,36263201,36270246,36274153,36276372,\t0\tPNPLA1\tcmpl\tcmpl\t-1,0,0,0,0,1,1,2,",
                "1006\tNM_207520\tchr2\t-\t55199326\t55277734\t55200291\t55277436\t8\t55199326,55200698,55200956,55201830,55209650,55214626,55255299,55276880,\t55200334,55200757,55201003,55201900,55209789,55214834,55255356,55277734,\t0\tRTN4\tcmpl\tcmpl\t2,0,1,0,2,1,1,0,",
                "192\tNM_021964\tchr3\t-\t124944512\t125094198\t124951184\t125032484\t9\t124944512,124953054,124996569,124997967,125006946,125032151,125042152,125050001,125093945,\t124952783,124953173,124996653,124998091,125007072,125032500,125042288,125050082,125094198,\t0\tZNF148\tcmpl\tcmpl\t0,1,1,0,0,0,-1,-1,-1,",
                "607\tNM_007105\tchr11\t-\t2908574\t2925175\t2909409\t2920931\t4\t2908574,2920625,2923813,2924688,\t2909865,2921020,2923939,2925175,\t0\tSLC22A18AS\tcmpl\tcmpl\t0,0,-1,-1,",
                "1139\tNM_000520\tchr15\t-\t72635775\t72668814\t72636417\t72668313\t14\t72635775,72637786,72638575,72638867,72640026,72640388,72641419,72642858,72643473,72645408,72646031,72647899,72648865,72668060,\t72636481,72637891,72638666,72639051,72640099,72640475,72641600,72642991,72643575,72645519,72646078,72647965,72648958,72668814,\t0\tHEXA\tcmpl\tcmpl\t2,2,1,0,2,2,1,0,0,0,1,1,1,0,",
                "1432\tNM_004974\tchr1\t-\t111145775\t111148975\t111145904\t111147404\t3\t111145775,111148012,111148849,\t111147567,111148344,111148975,\t0\tKCNA2\tcmpl\tcmpl\t0,-1,-1,",
                "167\tNM_001566\tchr2\t+\t99061320\t99198284\t99136511\t99198219\t26\t99061320,99135426,99136408,99137149,99149839,99152191,99152591,99154325,99155353,99155990,99160339,99162431,99163048,99165417,99169248,99170733,99172015,99175925,99179927,99181102,99182102,99182491,99185033,99189277,99193451,99198038,\t99061548,99135488,99136617,99137194,99149958,99152308,99152671,99154437,99155444,99156138,99160470,99162536,99163157,99165432,99169432,99170952,99172154,99175958,99180100,99181226,99182229,99182632,99185131,99189390,99193606,99198284,\t0\tINPP4A\tcmpl\tcmpl\t-1,-1,0,1,1,0,0,2,0,1,2,1,1,2,2,0,0,1,1,0,1,2,2,1,0,2,",
                "877\tNM_006941\tchr22\t-\t38368318\t38380539\t38369501\t38379791\t4\t38368318,38373873,38379363,38380345,\t38370205,38374142,38379875,38380539,\t0\tSOX10\tcmpl\tcmpl\t1,2,0,-1,",
                "605\tNM_003704\tchr4\t+\t2627158\t2734302\t2632731\t2733595\t19\t2627158,2628136,2632661,2641461,2648411,2659529,2661284,2661538,2664564,2664835,2673847,2691232,2692424,2695312,2696672,2698089,2701406,2717749,2733501,\t2627271,2628304,2632896,2641586,2648559,2659607,2661397,2661781,2664718,2665015,2674099,2691431,2692697,2695601,2696856,2698320,2702271,2717831,2734302,\t0\tFAM193A\tcmpl\tcmpl\t-1,-1,0,0,2,0,0,2,2,0,0,0,1,1,2,0,0,1,2,",
                "817\tNM_003796\tchr19\t+\t30433145\t30507519\t30433454\t30505976\t11\t30433145,30462099,30476129,30477188,30496267,30496557,30498376,30499911,30502000,30503191,30505793,\t30433571,30462134,30476208,30477324,30496359,30496615,30498545,30500260,30502143,30503438,30507519,\t0\tURI1\tcmpl\tcmpl\t0,0,2,0,1,0,1,2,0,2,0,",
                "1455\tNM_138430\tchr13\t-\t114076254\t114107839\t114077136\t114107752\t7\t114076254,114078531,114079366,114083266,114088056,114098739,114107538,\t114077294,114078664,114079494,114083407,114088182,114098904,114107839,\t0\tADPRHL1\tcmpl\tcmpl\t1,0,1,1,1,1,0,",
                "842\tNM_002418\tchr6\t-\t33762448\t33771793\t33762601\t33768940\t5\t33762448,33763279,33766881,33768823,33771729,\t33762612,33763382,33766998,33768947,33771793,\t0\tMLN\tcmpl\tcmpl\t1,0,0,0,-1,",
                "696\tNM_005716\tchr19\t-\t14588570\t14606961\t14589227\t14593788\t9\t14588570,14589495,14590223,14591116,14591404,14593500,14602467,14603668,14606848,\t14589379,14589577,14590336,14591297,14591590,14593818,14602555,14603724,14606961,\t0\tGIPC1\tcmpl\tcmpl\t1,0,1,0,0,0,-1,-1,-1,",
                "915\tNM_015911\tchr1\t+\t43312243\t43318146\t43316629\t43317484\t2\t43312243,43316620,\t43312328,43318146,\t0\tZNF691\tcmpl\tcmpl\t-1,0,",
                "113\tNM_016488\tchr12\t+\t42719946\t42842422\t42729704\t42840420\t13\t42719946,42729684,42745686,42748962,42768664,42778741,42781257,42787371,42792655,42835116,42836442,42839867,42840393,\t42720031,42729776,42745851,42749024,42768876,42778798,42781337,42787491,42792796,42835231,42836543,42840092,42842422,\t0\tPPHLN1\tcmpl\tcmpl\t-1,0,0,0,2,1,1,0,0,0,1,0,0,",
                "1374\tNM_000123\tchr13\t+\t103498190\t103528351\t103498616\t103528253\t15\t103498190,103504467,103506106,103506637,103508401,103510624,103513856,103514379,103518016,103518611,103518981,103520462,103524547,103525608,103527656,\t103498704,103504643,103506222,103506724,103508462,103510768,103514064,103515453,103518261,103518731,103519195,103520607,103524748,103525693,103528351,\t0\tERCC5\tcmpl\tcmpl\t0,1,0,2,2,0,0,1,1,0,0,1,2,2,0,",
                "18\tNM_012158\tchr13\t-\t77579388\t77601331\t77581279\t77595995\t5\t77579388,77589543,77592734,77595647,77600961,\t77581923,77589715,77592857,77595996,77601331,\t0\tFBXL3\tcmpl\tcmpl\t1,0,0,0,-1,",
                "27\tNM_170606\tchr7\t-\t151832009\t152133090\t151833916\t152132871\t59\t151832009,151835880,151836270,151836759,151841797,151842237,151843683,151845117,151847984,151848526,151849789,151851094,151851351,151852994,151853289,151855947,151859201,151864230,151866270,151868348,151871215,151873275,151876918,151877795,151880058,151882642,151884346,151884799,151891093,151891313,151891524,151892991,151896363,151900018,151902190,151904384,151917607,151919085,151919657,151921099,151921519,151927007,151927304,151932901,151935791,151944986,151946960,151947937,151949023,151949630,151960100,151962122,151970789,152007050,152008882,152012222,152027685,152055671,152132710,\t151834009,151835989,151836344,151836876,151841966,151842380,151843820,151846237,151848092,151848666,151850039,151851231,151851530,151853142,151853431,151856157,151860911,151864463,151866334,151868427,151871327,151875095,151877211,151879679,151880241,151882716,151884561,151884932,151891213,151891346,151891653,151893096,151896544,151900149,151902310,151904513,151917820,151919151,151919767,151921264,151921701,151927112,151927406,151933018,151935911,151945705,151947038,151948051,151949175,151949800,151960215,151962294,151970952,152007160,152009031,152012423,152027824,152055760,152133090,\t0\tKMT2C\tcmpl\tcmpl\t0,2,0,0,2,0,1,0,0,1,0,1,2,1,0,0,0,1,0,2,1,2,0,0,0,1,2,1,1,1,1,1,0,1,1,1,1,1,2,2,0,0,0,0,0,1,1,1,2,0,2,1,0,1,2,2,1,2,0,",
                "155\tNM_000067\tchr8\t+\t86376130\t86393721\t86376310\t86393018\t7\t86376130,86377500,86385921,86386552,86388026,86389348,86392898,\t86376344,86377698,86386040,86386645,86388089,86389504,86393721,\t0\tCA2\tcmpl\tcmpl\t0,1,1,0,0,0,0,",
                "1347\tNM_178273\tchr7\t+\t99971067\t99997722\t99971279\t99997227\t5\t99971067,99971666,99996913,99997203,99997407,\t99971343,99972056,99996963,99997235,99997722,\t0\tPILRA\tcmpl\tcmpl\t0,1,1,0,-1,",
                "589\tNM_198589\tchr19\t+\t572453\t583493\t572634\t582577\t8\t572453,579499,580378,580645,581314,582305,582513,582749,\t572701,579656,580461,580782,581591,582330,582582,583493,\t0\tBSG\tcmpl\tcmpl\t0,1,2,1,0,1,2,-1,",
                "883\tNM_031957\tchr17\t-\t39182278\t39183454\t39182882\t39183407\t1\t39182278,\t39183454,\t0\tKRTAP1-5\tcmpl\tcmpl\t0,",
                "1\tNM_024561\tchr13\t+\t41885340\t41951166\t41885664\t41949738\t20\t41885340,41890981,41892941,41894802,41897191,41899833,41902859,41905409,41910785,41929279,41932439,41932945,41936166,41941574,41943225,41946338,41946867,41947772,41948877,41949540,\t41885718,41891066,41893046,41894960,41897326,41899987,41902979,41905505,41910892,41929352,41932609,41933098,41936295,41941788,41943419,41946447,41946966,41947916,41948975,41951166,\t0\tNAA16\tcmpl\tcmpl\t0,0,1,1,0,0,1,1,1,0,1,0,0,0,1,0,1,1,1,0,",
                "1367\tNM_022122\tchr11\t-\t102562414\t102576468\t102562496\t102576445\t10\t102562414,102563668,102564636,102565697,102567101,102567404,102573483,102573700,102575267,102576343,\t102562741,102563772,102564796,102565828,102567222,102567566,102573612,102573849,102575506,102576468,\t0\tMMP27\tcmpl\tcmpl\t1,2,1,2,1,1,1,2,0,0,",
                "860\tNM_001863\tchr19\t+\t36139124\t36149686\t36142145\t36149549\t4\t36139124,36142134,36145472,36149495,\t36139305,36142251,36145573,36149686,\t0\tCOX6B1\tcmpl\tcmpl\t-1,0,1,0,",
                "28\tNM_002585\tchr1\t+\t164528596\t164821060\t164529059\t164815913\t9\t164528596,164532474,164761730,164768935,164776778,164781226,164789308,164790773,164815820,\t164529250,164532548,164761975,164769126,164776914,164781386,164789421,164790863,164821060,\t0\tPBX1\tcmpl\tcmpl\t0,2,1,0,2,0,1,0,0,",
                "1131\tNM_002732\tchr9\t-\t71627448\t71629039\t71627952\t71629008\t1\t71627448,\t71629039,\t0\tPRKACG\tcmpl\tcmpl\t0,",
                "12\tNM_152534\tchr3\t-\t27152393\t27410951\t27152762\t27394373\t39\t27152393,27157430,27157565,27161250,27173370,27182972,27184935,27203951,27204191,27213309,27215929,27216140,27233519,27243000,27243918,27297786,27326092,27326330,27329188,27332107,27332752,27332974,27335078,27337103,27338669,27343186,27346237,27349349,27350416,27352439,27353589,27355787,27363667,27385762,27387576,27393955,27394302,27409013,27410715,\t27152811,27157486,27157618,27161359,27173481,27183073,27184965,27204092,27204229,27213364,27216016,27216324,27233733,27243071,27244048,27297862,27326195,27326452,27329234,27332245,27332881,27333077,27335143,27337181,27338731,27343326,27346462,27349436,27350496,27352507,27353668,27355829,27363752,27385861,27387707,27394016,27394410,27409053,27410951,\t0\tNEK10\tcmpl\tcmpl\t2,0,1,0,0,1,1,1,2,1,1,0,2,0,2,1,0,1,0,0,0,2,0,0,1,2,2,2,0,1,0,0,2,2,0,2,0,-1,-1,",
                "1615\tNM_145806\tchr10\t+\t135122392\t135126666\t135122447\t135126370\t6\t135122392,135122893,135123279,135123667,135125219,135126291,\t135122600,135122967,135123481,135123792,135125345,135126666,\t0\tZNF511\tcmpl\tcmpl\t0,0,2,0,2,2,",
                "25\tNM_170771\tchr6\t-\t135238527\t135271260\t135239552\t135271191\t6\t135238527,135253913,135260403,135263546,135264956,135271053,\t135240005,135254170,135260553,135263702,135265104,135271260,\t0\tALDH8A1\tcmpl\tcmpl\t0,1,1,1,0,0,",
                "98\tNM_018317\tchr4\t+\t26585545\t26757835\t26585815\t26756569\t21\t26585545,26614790,26616029,26622234,26638832,26640392,26641762,26661218,26667954,26673770,26675397,26685296,26689966,26719554,26721702,26737076,26741485,26744129,26750032,26755441,26756494,\t26585914,26614863,26616075,26622310,26638907,26640456,26641809,26661329,26668027,26673809,26675510,26685371,26690029,26719639,26721747,26737109,26741595,26744221,26750148,26755512,26757835,\t0\tTBC1D19\tcmpl\tcmpl\t0,0,1,2,0,0,1,0,0,1,1,0,0,0,1,1,1,0,2,1,0,",
                "937\tNM_006936\tchr21\t-\t46225531\t46238044\t46226865\t46237883\t4\t46225531,46228961,46233890,46237862,\t46226955,46229033,46234019,46238044,\t0\tSUMO3\tcmpl\tcmpl\t0,0,0,0,",
                "700\tNM_022497\tchr3\t-\t15090018\t15106844\t15093947\t15106701\t4\t15090018,15094886,15100875,15106567,\t15094140,15094974,15100982,15106844,\t0\tMRPS25\tcmpl\tcmpl\t2,1,2,0,",
                "732\tNM_003721\tchr19\t+\t19303007\t19312678\t19304755\t19312528\t10\t19303007,19303768,19304747,19307771,19307994,19308329,19308915,19309465,19309962,19312457,\t19303363,19303909,19304942,19307855,19308060,19308430,19309041,19309532,19310043,19312678,\t0\tRFXANK\tcmpl\tcmpl\t-1,-1,0,1,1,1,0,0,1,1,",
                "1164\tNM_018247\tchr6\t-\t75962637\t75994632\t75965817\t75994354\t7\t75962637,75968495,75969062,75970539,75974946,75977356,75994117,\t75966011,75968702,75969206,75970627,75975054,75977464,75994632,\t0\tTMEM30A\tcmpl\tcmpl\t1,1,1,0,0,0,0,",
                "776\tNM_004036\tchr2\t-\t25042038\t25142886\t25042800\t25141856\t22\t25042038,25043592,25044385,25045379,25046077,25047246,25048913,25050414,25050770,25053577,25054530,25057353,25057662,25059785,25061313,25062741,25064127,25064424,25065122,25095438,25141181,25142551,\t25042983,25043717,25044509,25045499,25046224,25047405,25048995,25050477,25051030,25053694,25054618,25057515,25057805,25059914,25061491,25062900,25064255,25064536,25065253,25095588,25142053,25142886,\t0\tADCY3\tcmpl\tcmpl\t0,1,0,0,0,0,2,2,0,0,2,2,0,0,2,2,0,2,0,0,0,-1,",
                "957\tNM_021999\tchr13\t+\t48807273\t48836232\t48807496\t48835360\t6\t48807273,48827943,48830312,48832261,48832932,48835274,\t48807613,48828072,48830519,48832372,48833083,48836232,\t0\tITM2B\tcmpl\tcmpl\t0,0,0,0,0,1,",
                "943\tNM_018215\tchr19\t-\t46969747\t46974820\t46971817\t46974292\t3\t46969747,46972989,46974593,\t46971834,46974371,46974820,\t0\tPNMA8A\tcmpl\tcmpl\t1,0,-1,",
                "122\tNM_012315\tchr19\t-\t51505768\t51512890\t51506366\t51512803\t5\t51505768,51506959,51509713,51512438,51512760,\t51506516,51507096,51509979,51512595,51512890,\t0\tKLK9\tcmpl\tcmpl\t0,1,2,1,0,",
                "619\tNM_001140\tchr17\t-\t4534213\t4544960\t4534894\t4544946\t14\t4534213,4535183,4535475,4536155,4536440,4536708,4539053,4540409,4541511,4541875,4542144,4542345,4542724,4544811,\t4535074,4535351,4535576,4536277,4536610,4536795,4539263,4540553,4541672,4541979,4542267,4542427,4542926,4544960,\t0\tALOX15\tcmpl\tcmpl\t0,0,1,2,0,0,0,0,1,2,2,1,0,0,",
                "1158\tNM_019896\tchr2\t+\t75185769\t75196859\t75185806\t75196549\t4\t75185769,75186467,75187231,75196535,\t75186019,75186552,75187273,75196859,\t0\tPOLE4\tcmpl\tcmpl\t0,0,1,1,",
                "1024\tNM_001660\tchr3\t-\t57557089\t57583215\t57557938\t57582867\t6\t57557089,57561274,57563042,57569624,57570110,57582800,\t57558025,57561400,57563114,57569734,57570191,57583215,\t0\tARF4\tcmpl\tcmpl\t0,0,0,1,1,0,",
                "1017\tNM_016584\tchr12\t+\t56732662\t56734194\t56732828\t56733888\t4\t56732662,56733209,56733474,56733726,\t56732990,56733308,56733621,56734194,\t0\tIL23A\tcmpl\tcmpl\t0,0,0,0,",
                "675\tNM_017507\tchr19\t-\t11832079\t11849824\t11832515\t11835067\t3\t11832079,11835008,11849631,\t11834157,11835069,11849824,\t0\tZNF823\tcmpl\tcmpl\t2,0,-1,",
                "10\tNM_032497\tchr19\t+\t9434447\t9454521\t9449225\t9453744\t7\t9434447,9435370,9448471,9449169,9449868,9451777,9452370,\t9434904,9435456,9448534,9449258,9449995,9451860,9454521,\t0\tZNF559\tcmpl\tcmpl\t-1,-1,-1,0,0,1,0,",
                "1\tNM_006203\tchr5\t-\t58264865\t58882324\t58270490\t58882201\t15\t58264865,58271483,58272176,58273017,58284319,58285581,58286630,58287658,58289198,58334685,58476420,58481014,58489325,58511602,58882154,\t58270907,58271666,58272299,58273172,58284419,58285746,58286729,58287831,58289292,58334798,58476470,58481088,58489362,58511794,58882324,\t0\tPDE4D\tcmpl\tcmpl\t0,0,0,1,0,0,0,1,0,1,2,0,2,2,0,",
                "1054\tNM_005024\tchr18\t+\t61575223\t61603345\t61582744\t61602476\t8\t61575223,61582735,61584689,61585198,61587021,61597278,61600281,61602071,\t61575274,61582912,61584755,61585336,61587139,61597421,61600437,61603345,\t0\tSERPINB10\tcmpl\tcmpl\t-1,0,0,0,0,1,0,0,",
                "2\tNM_015429\tchr3\t-\t100468178\t100712334\t100469338\t100712249\t35\t100468178,100470395,100471630,100472662,100473455,100484684,100489586,100493448,100494050,100497127,100498975,100508297,100511534,100513766,100515252,100523635,100527004,100565215,100566445,100567644,100568888,100569503,100570718,100581154,100583676,100585722,100593684,100594351,100595355,100604379,100604985,100617605,100621461,100645145,100712149,\t100469454,100470518,100471792,100472692,100473535,100484793,100489796,100493517,100494179,100497220,100499053,100508360,100511612,100513847,100515312,100523710,100527079,100565290,100566517,100567719,100568963,100569578,100570784,100581229,100583751,100585800,100593777,100594423,100595404,100604432,100605167,100617738,100621530,100645325,100712334,\t0\tABI3BP\tcmpl\tcmpl\t1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,2,1,1,1,0,",
                "618\tNM_016069\tchr16\t-\t4390249\t4401400\t4390319\t4401235\t5\t4390249,4390920,4391368,4393207,4401232,\t4390406,4390986,4391505,4393292,4401400,\t0\tPAM16\tcmpl\tcmpl\t0,0,1,0,0,",
                "838\tNM_033668\tchr10\t-\t33189245\t33224486\t33195996\t33224486\t16\t33189245,33195990,33197295,33199150,33200375,33200813,33208812,33209172,33211184,33211567,33212512,33214798,33217021,33218749,33221442,33224419,\t33190563,33196071,33197462,33199383,33200598,33201052,33209012,33209313,33211274,33211663,33212668,33215037,33217192,33218972,33221528,33224486,\t0\tITGB1\tcmpl\tcmpl\t-1,0,1,2,1,2,0,0,0,0,0,1,1,0,1,0,",
                "636\tNM_133476\tchr12\t-\t6775642\t6798541\t6776879\t6788686\t10\t6775642,6778196,6779925,6782381,6787292,6787828,6788111,6788620,6797332,6798263,\t6777281,6778355,6780004,6782606,6787626,6787876,6788349,6788691,6797392,6798541,\t0\tZNF384\tcmpl\tcmpl\t0,0,2,2,1,1,0,0,-1,-1,",
                "1655\tNM_015537\tchr9\t-\t140342022\t140353786\t140343845\t140353554\t15\t140342022,140344050,140344374,140344627,140346816,140347004,140347187,140347507,140348182,140348842,140349690,140350862,140351858,140352939,140353483,\t140343943,140344126,140344477,140344707,140346887,140347038,140347271,140347632,140348272,140348895,140349759,140350938,140352353,140353001,140353786,\t0\tNSMF\tcmpl\tcmpl\t1,0,2,0,1,0,0,1,1,2,2,1,1,2,0,",
                "882\tNM_024775\tchr2\t+\t39005326\t39009106\t39006132\t39009034\t3\t39005326,39006113,39008658,\t39005423,39006260,39009106,\t0\tGEMIN6\tcmpl\tcmpl\t-1,0,2,",
                "1513\tNM_172214\tchr12\t-\t121681390\t121736111\t121681926\t121712329\t17\t121681390,121682375,121682942,121686408,121687589,121687763,121690463,121691075,121693352,121693585,121698121,121701608,121706440,121707330,121708700,121711858,121735341,\t121681932,121682418,121683043,121686537,121687677,121687837,121690517,121691275,121693441,121693607,121698158,121701742,121706492,121707384,121708748,121712388,121736111,\t0\tCAMKK2\tcmpl\tcmpl\t0,2,0,0,2,0,0,1,2,1,0,1,0,0,0,0,-1,",
                "893\tNM_006503\tchr19\t+\t40476911\t40487671\t40477109\t40487212\t11\t40476911,40478052,40478275,40480200,40480430,40480641,40485723,40485976,40486192,40486568,40487098,\t40477145,40478151,40478462,40480347,40480540,40480735,40485891,40486053,40486361,40486624,40487671,\t0\tPSMC4\tcmpl\tcmpl\t0,0,0,1,1,0,1,1,0,1,0,",
                "1076\tNM_003099\tchr15\t+\t64388082\t64436433\t64388212\t64429817\t15\t64388082,64404771,64410315,64410986,64415701,64418277,64419372,64419929,64422114,64422426,64423885,64426862,64428528,64429059,64429766,\t64388371,64404883,64410443,64411053,64415745,64418419,64419451,64420005,64422228,64422520,64424091,64427006,64428609,64429131,64436433,\t0\tSNX1\tcmpl\tcmpl\t0,0,1,0,1,0,1,2,0,0,1,0,0,0,0,",
                "857\tNM_006368\tchr9\t+\t35732316\t35737005\t35732769\t35736723\t9\t35732316,35732992,35733211,35733392,35735105,35735302,35736044,35736223,35736388,\t35732898,35733140,35733279,35733482,35735212,35735371,35736129,35736308,35737005,\t0\tCREB3\tcmpl\tcmpl\t0,0,1,0,0,2,2,0,1,",
                "143\tNM_033244\tchr15\t+\t74287013\t74328735\t74287153\t74326836\t8\t74287013,74290344,74315168,74317197,74324912,74325496,74326818,74327512,\t74287282,74290817,74315749,74317268,74325056,74325763,74326871,74328735,\t0\tPML\tcmpl\tcmpl\t0,0,2,1,0,0,0,-1,",
                "813\tNM_016127\tchr8\t-\t29920527\t29940724\t29921403\t29940465\t6\t29920527,29923503,29924292,29927157,29931392,29940362,\t29921429,29923655,29924434,29927575,29931571,29940724,\t0\tSARAF\tcmpl\tcmpl\t1,2,1,0,1,0,",
                "1457\tNM_018364\tchr1\t-\t114304453\t114355098\t114308601\t114355034\t7\t114304453,114309720,114310843,114319831,114320292,114339984,114354331,\t114309075,114309829,114311011,114319974,114320430,114340658,114355098,\t0\tRSBN1\tcmpl\tcmpl\t0,2,2,0,0,1,0,",
                "625\tNM_033179\tchr11\t-\t5322243\t5323176\t5322243\t5323176\t1\t5322243,\t5323176,\t0\tOR51B4\tcmpl\tcmpl\t0,",
                "1080\tNM_024941\tchr5\t+\t64920557\t64961954\t64920887\t64960438\t13\t64920557,64931127,64931770,64933522,64942881,64946636,64948327,64951462,64954194,64956525,64957876,64960063,64960330,\t64920933,64931196,64931870,64933607,64943009,64946709,64948372,64951480,64954328,64956724,64957977,64960211,64961954,\t0\tTRAPPC13\tcmpl\tcmpl\t0,1,1,2,0,2,0,0,0,2,0,2,0,",
                "602\tNM_080594\tchr16\t-\t2303116\t2318413\t2303964\t2314644\t8\t2303116,2305585,2312278,2312740,2313096,2314176,2314573,2318055,\t2304064,2305727,2312432,2312843,2313288,2314332,2314761,2318413,\t0\tRNPS1\tcmpl\tcmpl\t2,1,0,2,2,2,0,-1,",
                "180\tNM_199511\tchr3\t-\t112323232\t112359990\t112324263\t112358752\t8\t112323232,112326022,112328824,112335556,112337814,112348959,112356874,112359173,\t112324610,112326103,112328928,112335705,112337951,112349116,112358763,112359990,\t0\tCCDC80\tcmpl\tcmpl\t1,1,2,0,1,0,0,-1,",
                "2076\tNM_152673\tchr3\t+\t195447752\t195460424\t195447878\t195460089\t6\t195447752,195451550,195452225,195452668,195456518,195460020,\t195447954,195451997,195452383,195453443,195456610,195460424,\t0\tMUC20\tcmpl\tcmpl\t0,1,1,0,1,0,",
                "1141\tNM_007332\tchr8\t-\t72933485\t72987819\t72935140\t72987644\t27\t72933485,72936048,72938194,72942135,72945878,72946482,72948522,72950217,72951099,72951961,72958747,72959382,72963012,72964833,72965987,72967670,72967920,72969151,72969951,72971624,72973859,72975033,72975697,72977685,72981257,72983945,72987533,\t72935351,72936146,72938308,72942204,72946061,72946612,72948692,72950307,72951262,72952032,72958843,72959442,72963106,72965000,72966102,72967835,72968090,72969252,72970051,72971673,72973996,72975179,72975806,72977793,72981433,72984102,72987819,\t0\tTRPA1\tcmpl\tcmpl\t2,0,0,0,0,2,0,0,2,0,0,0,2,0,2,2,0,1,0,2,0,1,0,0,1,0,0,",
                "211\tNM_152550\tchr5\t+\t145316125\t145442879\t145317491\t145442264\t10\t145316125,145317385,145379620,145383620,145393309,145427334,145428637,145435543,145439428,145441988,\t145316257,145317869,145379890,145383716,145393624,145427426,145428808,145435776,145439787,145442879,\t0\tSH3RF2\tcmpl\tcmpl\t-1,0,0,0,0,0,2,2,1,0,",
                "1494\tNM_032498\tchrX\t-\t119206228\t119211707\t119206480\t119211517\t4\t119206228,119209864,119210841,119211438,\t119206810,119209910,119211253,119211707,\t0\tRHOXF2\tcmpl\tcmpl\t0,2,1,0,",
                "724\tNM_007216\tchr11\t-\t18300216\t18343721\t18301428\t18332422\t22\t18300216,18303496,18305341,18306892,18308137,18309081,18309439,18312988,18314445,18316566,18317545,18318344,18319105,18320338,18322374,18326968,18327681,18330492,18332287,18332933,18333460,18343492,\t18301489,18303767,18305448,18307006,18308257,18309237,18309560,18313566,18314523,18316716,18317669,18318531,18319264,18320517,18322463,18327040,18327894,18330626,18332480,18332998,18333571,18343721,\t0\tHPS5\tcmpl\tcmpl\t2,1,2,2,2,2,1,2,2,2,1,0,0,1,2,2,2,0,0,-1,-1,-1,",
                "179\tNM_145735\tchr13\t+\t111766965\t111947542\t111767873\t111944679\t19\t111766965,111806251,111857635,111862218,111870025,111885551,111896218,111896545,111919894,111926160,111927077,111927878,111929933,111932618,111932884,111935485,111938493,111940700,111944464,\t111768038,111806338,111857720,111862349,111870227,111885640,111896313,111896641,111920017,111926299,111927137,111928025,111930020,111932697,111933024,111935710,111938587,111940790,111947542,\t0\tARHGEF7\tcmpl\tcmpl\t0,0,0,1,0,1,0,2,2,2,0,0,0,0,1,0,0,1,1,",
                "293\tNM_138402\tchr2\t+\t231191893\t231268445\t231191984\t231267611\t19\t231191893,231193471,231222519,231223678,231226328,231235622,231236312,231248224,231249938,231253273,231254633,231256801,231258128,231261471,231264841,231265669,231266080,231266378,231267512,\t231192016,231193546,231222682,231223847,231226412,231235682,231236366,231248290,231250019,231253348,231254738,231256944,231258176,231261513,231264957,231265778,231266158,231266522,231268445,\t0\tSP140L\tcmpl\tcmpl\t0,2,2,0,1,1,1,1,1,1,1,1,0,0,0,2,0,0,0,",
                "1180\tNM_017950\tchr17\t+\t78010430\t78074412\t78010461\t78073574\t20\t78010430,78011921,78013610,78021077,78022381,78023704,78023862,78032292,78032656,78039283,78055344,78055674,78058541,78059801,78061405,78061809,78063562,78069061,78071043,78073325,\t78010490,78011985,78014069,78021201,78022560,78023788,78024082,78032450,78032779,78039405,78055588,78055857,78058787,78060015,78061575,78061901,78063683,78069250,78071202,78074412,\t0\tCCDC40\tcmpl\tcmpl\t0,2,0,0,1,0,0,1,0,0,2,0,0,0,1,0,2,0,0,0,",
                "100\tNM_001941\tchr18\t-\t28569330\t28622781\t28574140\t28622626\t16\t28569330,28576756,28581583,28584107,28586872,28587981,28588234,28598036,28598631,28602301,28604314,28605725,28609474,28610938,28612157,28622557,\t28574338,28577014,28581705,28584332,28587097,28588124,28588491,28598222,28598766,28602468,28604459,28605881,28609594,28611138,28612242,28622781,\t0\tDSC3\tcmpl\tcmpl\t0,0,1,1,1,2,0,0,0,1,0,0,0,1,0,0,",
                "933\tNM_138568\tchr19\t-\t45715634\t45737469\t45716326\t45735110\t10\t45715634,45719330,45720785,45721454,45728035,45730919,45731231,45731422,45735020,45737450,\t45716615,45719452,45720941,45721577,45728171,45731030,45731332,45731524,45735132,45737469,\t0\tEXOC3L2\tcmpl\tcmpl\t2,0,0,0,2,2,0,0,0,-1,",
                "1735\tNM_004769\tchr7\t+\t150745378\t150749843\t150745972\t150749739\t11\t150745378,150747192,150747567,150747844,150748125,150748258,150748896,150749069,150749252,150749502,150749660,\t150746506,150747343,150747695,150748040,150748182,150748406,150748988,150749149,150749324,150749561,150749843,\t0\tASIC3\tcmpl\tcmpl\t0,0,1,0,1,1,2,1,0,0,2,",
                "95\tNM_033266\tchr16\t-\t23701625\t23724821\t23702151\t23724508\t22\t23701625,23702449,23702622,23703283,23703504,23706048,23706339,23706520,23707214,23711859,23712279,23713472,23713710,23713944,23716203,23717650,23718074,23718327,23721492,23721836,23722233,23724415,\t23702364,23702517,23702746,23703411,23703652,23706248,23706439,23706710,23707299,23712025,23712435,23713594,23713858,23714023,23716468,23717752,23718182,23718400,23721565,23721870,23722339,23724821,\t0\tERN2\tcmpl\tcmpl\t0,1,0,1,0,1,0,2,1,0,0,1,0,2,1,1,1,0,2,1,0,0,",
                "911\tNM_015349\tchr6\t+\t42788793\t42836298\t42789760\t42833184\t12\t42788793,42789755,42790533,42790672,42796230,42819829,42821375,42823593,42824828,42827999,42830247,42832396,\t42788951,42789801,42790582,42790741,42797910,42819935,42821476,42823655,42824974,42828094,42830350,42836298,\t0\tBICRAL\tcmpl\tcmpl\t-1,0,2,0,0,0,1,0,2,1,0,1,",
                "1413\tNM_003795\tchr6\t-\t108532420\t108582464\t108533352\t108582125\t4\t108532420,108535701,108544153,108581963,\t108533458,108535826,108544249,108582464,\t0\tSNX3\tcmpl\tcmpl\t2,0,0,0,",
                "1146\tNM_016565\tchr11\t-\t73583712\t73587890\t73584159\t73584423\t2\t73583712,73587801,\t73584439,73587890,\t0\tCOA4\tcmpl\tcmpl\t0,-1,",
                "108\tNM_005128\tchr21\t+\t37536838\t37666572\t37537031\t37665869\t37\t37536838,37537005,37571367,37572628,37581012,37583850,37584271,37586378,37586739,37591669,37595528,37597862,37599983,37602747,37605101,37609559,37610898,37612062,37617345,37619814,37620677,37623459,37626069,37632974,37635843,37636045,37642310,37649318,37650272,37650506,37652582,37653780,37660311,37661053,37661342,37664401,37665617,\t37536891,37537169,37571549,37572799,37581202,37583949,37584395,37586488,37586854,37591790,37595648,37597965,37600175,37603432,37605373,37609712,37610999,37612253,37618975,37619926,37620866,37623582,37626207,37633030,37635948,37636112,37642455,37649398,37650382,37650653,37652644,37653909,37660448,37661109,37661504,37664531,37666572,\t0\tDOPEY2\tcmpl\tcmpl\t-1,0,0,2,2,0,0,1,0,1,2,2,0,0,1,0,0,2,1,2,0,0,0,0,2,2,0,1,0,2,2,1,1,0,2,2,0,",
                "785\tNM_021052\tchr6\t+\t26217147\t26217711\t26217202\t26217595\t1\t26217147,\t26217711,\t0\tHIST1H2AE\tcmpl\tcmpl\t0,",
                "587\tNM_183337\tchr16\t-\t318299\t325943\t319267\t325911\t17\t318299,319501,320521,320742,320982,321200,321397,321538,322861,323474,323759,324042,324213,324975,325282,325401,325848,\t319382,319584,320660,320830,321098,321314,321459,321568,322930,323556,323836,324101,324265,325082,325333,325498,325943,\t0\tRGS11\tcmpl\tcmpl\t2,0,2,1,2,2,0,0,0,2,0,1,0,1,1,0,0,",
                "1354\tNM_021970\tchr4\t-\t100799494\t100815703\t100803150\t100815120\t7\t100799494,100805218,100806698,100808452,100813156,100815111,100815491,\t100803224,100805282,100806832,100808511,100813191,100815157,100815703,\t0\tLAMTOR3\tcmpl\tcmpl\t1,0,1,2,0,0,-1,",
                "145\tNM_004370\tchr6\t-\t75794041\t75915623\t75796262\t75912508\t66\t75794041,75797292,75798821,75799825,75801038,75801205,75804823,75806968,75811315,75811714,75812312,75813472,75814921,75816134,75818733,75822919,75823317,75825499,75825734,75827097,75828758,75829065,75831017,75833045,75833663,75833970,75834842,75836066,75838011,75839806,75840567,75841655,75843008,75843573,75844441,75847152,75848035,75848163,75848537,75851747,75852963,75855041,75855817,75857390,75858073,75860856,75861582,75861846,75862048,75864131,75865377,75865972,75875222,75884753,75887378,75890654,75892765,75893569,75898077,75898932,75899267,75901416,75901927,75904546,75912435,75915492,\t75796273,75797463,75798890,75800014,75801105,75801241,75804895,75807022,75811369,75811768,75812408,75813526,75815008,75816212,75818883,75823029,75823460,75825638,75825773,75827262,75828902,75829189,75831157,75833120,75833810,75834087,75834989,75836186,75838141,75839949,75840697,75841798,75843138,75843713,75844571,75847295,75848056,75848296,75848677,75851873,75853104,75855171,75855960,75857520,75858213,75861003,75861747,75861966,75862198,75864253,75865570,75866239,75875495,75885026,75887651,75890927,75893368,75893860,75898251,75899097,75899531,75901476,75902071,75904663,75912543,75915623,\t0\tCOL12A1\tcmpl\tcmpl\t1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,2,1,1,1,1,0,1,1,1,1,1,1,0,1,0,1,0,1,0,1,1,0,1,1,1,0,1,0,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,-1,"
        });
        fac.files.put("test.vcf", vcfText);

        TestRefGeneProcessor t = new TestRefGeneProcessor();
        RefGeneReader R = new RefGeneReader(fac, t);
        R.process("test.vcf");
        assertEquals(100, t.accessions.size());
    }
}
